<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="View/styles.css">
    <title>Twitter</title>
</head>

<body>
    <header id="header">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-twitter" viewBox="0 0 16 16">
            <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" />
        </svg>
        <h1>twitter</h1>
    </header>

    <?php
    if (isset($_SESSION['user'])) {
        if ($_SESSION['user']->getRol() == 2) {
            echo '<form action="index.php?controller="article" method="post" id="form-post">
            <input type="text" name="titulo" id="titulo" placeholder="Titulo" required>
            <section id="post-send-section">
            <textarea name="post" id="post" placeholder="Escribe algo..."></textarea>
            <input type="image" src="View/img/send.png" name="publicar" id="post-send">
            </section>
            </form>';
        }
        echo '<nav id="nav-bar">
        <ul>
            <li><a href="index.php"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-alarm" viewBox="0 0 16 16">
                        <path d="M8.5 5.5a.5.5 0 0 0-1 0v3.362l-1.429 2.38a.5.5 0 1 0 .858.515l1.5-2.5A.5.5 0 0 0 8.5 9V5.5z" />
                        <path d="M6.5 0a.5.5 0 0 0 0 1H7v1.07a7.001 7.001 0 0 0-3.273 12.474l-.602.602a.5.5 0 0 0 .707.708l.746-.746A6.97 6.97 0 0 0 8 16a6.97 6.97 0 0 0 3.422-.892l.746.746a.5.5 0 0 0 .707-.708l-.601-.602A7.001 7.001 0 0 0 9 2.07V1h.5a.5.5 0 0 0 0-1h-3zm1.038 3.018a6.093 6.093 0 0 1 .924 0 6 6 0 1 1-.924 0zM0 3.5c0 .753.333 1.429.86 1.887A8.035 8.035 0 0 1 4.387 1.86 2.5 2.5 0 0 0 0 3.5zM13.5 1c-.753 0-1.429.333-1.887.86a8.035 8.035 0 0 1 3.527 3.527A2.5 2.5 0 0 0 13.5 1z" />
                    </svg>Post recientes</a></li>
            <li><a href="index.php?controller=article&fp=1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-balloon-heart" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="m8 2.42-.717-.737c-1.13-1.161-3.243-.777-4.01.72-.35.685-.451 1.707.236 3.062C4.16 6.753 5.52 8.32 8 10.042c2.479-1.723 3.839-3.29 4.491-4.577.687-1.355.587-2.377.236-3.061-.767-1.498-2.88-1.882-4.01-.721L8 2.42Zm-.49 8.5c-10.78-7.44-3-13.155.359-10.063.045.041.089.084.132.129.043-.045.087-.088.132-.129 3.36-3.092 11.137 2.624.357 10.063l.235.468a.25.25 0 1 1-.448.224l-.008-.017c.008.11.02.202.037.29.054.27.161.488.419 1.003.288.578.235 1.15.076 1.629-.157.469-.422.867-.588 1.115l-.004.007a.25.25 0 1 1-.416-.278c.168-.252.4-.6.533-1.003.133-.396.163-.824-.049-1.246l-.013-.028c-.24-.48-.38-.758-.448-1.102a3.177 3.177 0 0 1-.052-.45l-.04.08a.25.25 0 1 1-.447-.224l.235-.468ZM6.013 2.06c-.649-.18-1.483.083-1.85.798-.131.258-.245.689-.08 1.335.063.244.414.198.487-.043.21-.697.627-1.447 1.359-1.692.217-.073.304-.337.084-.398Z" />
                    </svg>Post de tus amigos</a></li>
            <li><a href=""><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                    </svg>Buscar</a></li>
                    <li><a href="index.php?controller=article&yp=1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                    </svg>Tus posts</a></li>
            <li><a href="index.php?controller=user&yf=1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                    </svg>Tus amigos</a></li>
            <li><a href=""><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
                        <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z" />
                        <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z" />
                    </svg>Configuración</a></li>
            <li>
            <a href="index.php?controller=user&lo=1">Cerrar Sesión</a>
            </li>
            <button id="menu-button">X</button>


        </ul>
        
    </nav>';
        if ($friends) {
            foreach ($friends as $user) {
                echo '<section id="friends-window">';
                echo '<article id="friend-box">
                <img id ="friend-pict" src="View/img/profile-pic.jpg">
                <h3>' . $user->getUserName() . '</h3>
                <a id="unfollow" href="index.php?controller=user&yf=1&unfol=' . $user->getId() . '">
                <button id="login-button">Unfollow</button>
                </a>
                </article>
                </section>';
            }
        } elseif (!empty($_GET['art'])) {
            echo '<section id="single-comment-window">';
            echo '<article id="post-box">';
            echo '<h3>' . $article->getTitle() . '</h3>';
            echo '<p>' . $article->getText() . '</p>';
            echo '<section id="bottom-article-section">
            <p id="date">' . $article->getDate() . '</p>
            </section>';
            echo '</article>
            <form id="comment-form" action="" method="post">
            <textarea rows="3" name="comment" id="comment-send"></textarea>
            <input type="hidden" name="id_articulo" value="' . $article->getId() . '"/>
            <input id="comment-submit" type="submit" value="send-comment"/>
            </form>';
            foreach ($comments as $comment) {
                echo '<article id="comment-answer">';
                echo '<p style="color:black;">' . $comment->getAuthor()->getUserName() . '</p>';
                echo '<p>' . $comment->getComment() . '</p>';
                echo '</article>';
                echo '<form id="answer-form" action="" method="post">
                <textarea rows="3" name="comment" id="answer-send"></textarea>
                <input type="hidden" name="id_comentario" value="' . $comment->getId() . '"/>
                <input type="hidden" name="id_articulo" value="' . $article->getId() . '"/>
                <input id="answer-submit" type="submit" value="send-comment"/>
                </form>';
                $comment->showAnswers($article->getId());
                var_dump($_POST);
                /* echo '<article id="comment-box">';
                echo '<p style="color:black;">' . $comment->getAuthor()->getUserName() . '</p>';
                echo '<p>' . $comment->getComment() . '</p>';
                echo '</article>';
                echo '<form id="answer-form" action="" method="post">
                <textarea rows="3" name="comment" id="answer-send"></textarea>
                <input type="hidden" name="id_comentario" value="' . $comment->getId() . '"/>
                <input type="hidden" name="id_articulo" value="' . $article->getId() . '"/>
                <input id="answer-submit" type="submit" value="send-comment"/>
                </form>';
                var_dump(CommentRepository::getAnswers($comment->getId()));
                foreach ($comment->getAnswers() as $answer) {
                    echo '<article id="comment-answer">';
                    echo '<p style="color:black;">' . $answer->getAuthor()->getUserName() . '</p>';
                    echo '<p>' . $answer->getComment() . '</p>';
                    echo '</article>'; */
            }
            echo '</section>';
        } else {
            echo '<section id="post-window">';
            foreach ($articles as $art) {
                echo '<article id="post-box">
                <a id="perfil-box" href="">
                <img id ="profile-pic" src="View/img/profile-pic.jpg">
                <h6>' . $art->getAuthor()->getUsername() . '</h6>
                </a>';
                echo '<h3>' . $art->getTitle() . '</h3>';
                echo '<p>' . $art->getText() . '</p>';
                echo '<section id="bottom-article-section">
                <a class="comment-button" href="index.php?controller=comment&art=' . $art->getId() . '"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat" viewBox="0 0 16 16">
                <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"/>
                </svg></a>
                <p id="date">' . $art->getDate() . '</p>
                </section>';
                echo '</article>';
            }
            echo '</section>';
        }
    } else {
        echo '
        <section id="login-container">
        <form id="login-form" action="index.php?controller=user" method="post">
        <label>Usuario</label>
        <input type="text" name="username" id="username-input" required>
        <label>Contraseña</label>
        <input type="password" name="password" id="pass-input" required>
        <input type="submit" value="Iniciar Sesión" id="login-button">
        </form>
        </section>';
    }


    ?>
    <script src="View/main.js"></script>
</body>

</html>